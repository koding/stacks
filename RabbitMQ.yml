# Here is your stack preview
# You can make advanced changes like modifying your VM,
# installing packages, and running shell commands.

provider:
  aws:
    access_key: '${var.aws_access_key}'
    secret_key: '${var.aws_secret_key}'
resource:
  aws_instance:
    rabbitmq:
      instance_type: t2.nano
      ami: ''
      tags:
        Name: '${var.koding_user_username}-${var.koding_group_slug}'
      user_data: |-
        set -e
        export DEBIAN_FRONTEND=noninteractive
        #Adding new sources for Version 3.6.5
        echo 'deb http://www.rabbitmq.com/debian/ testing main' | sudo tee /etc/apt/sources.list.d/rabbitmq.list
        wget -O- https://www.rabbitmq.com/rabbitmq-release-signing-key.asc |sudo apt-key add -
        #Updating packages
        apt-get update -y
        #Installing RabbitMQ
        apt-get -y install rabbitmq-server
        
